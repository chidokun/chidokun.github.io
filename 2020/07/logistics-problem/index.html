<!doctype html><html lang=vi>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=generator content="Hugo 0.87.0 with theme Tranquilpeak 0.4.8-BETA">
<meta name=author content="Nguyễn Tuấn">
<meta name=keywords content="shopee code league,logistics,development,programming,chidokun,lập trình">
<meta name=description content="Logistics Problem là challenge thứ x của Shopee Code League 2020 - một cuộc thi về Code và Data kéo dài 2 tháng với các challenge khác nhau. Bài toán Data Analytics lần này tiếp tục là một chủ đề về Logistics - hay nói nôm na là &ldquo;ship hàng&rdquo;. Nhiệm vụ của các đội là xác định các đơn hàng giao trễ hẹn dựa trên data và bộ rule cho sẵn. Sau một khoảng thời gian tìm hiểu và implement thì mình xin giới thiệu đến các bạn giải pháp của team (score: 1.0/1.0).">
<meta property="og:description" content="Logistics Problem là challenge thứ x của Shopee Code League 2020 - một cuộc thi về Code và Data kéo dài 2 tháng với các challenge khác nhau. Bài toán Data Analytics lần này tiếp tục là một chủ đề về Logistics - hay nói nôm na là &ldquo;ship hàng&rdquo;. Nhiệm vụ của các đội là xác định các đơn hàng giao trễ hẹn dựa trên data và bộ rule cho sẵn. Sau một khoảng thời gian tìm hiểu và implement thì mình xin giới thiệu đến các bạn giải pháp của team (score: 1.0/1.0).">
<meta property="og:type" content="article">
<meta property="og:title" content="Logistics Problem (Shopee Code League 2020)">
<meta name=twitter:title content="Logistics Problem (Shopee Code League 2020)">
<meta property="og:url" content="https://chidokun.github.io/2020/07/logistics-problem/">
<meta property="twitter:url" content="https://chidokun.github.io/2020/07/logistics-problem/">
<meta property="og:site_name" content="Nguyễn Tuấn's Blog">
<meta property="og:description" content="Logistics Problem là challenge thứ x của Shopee Code League 2020 - một cuộc thi về Code và Data kéo dài 2 tháng với các challenge khác nhau. Bài toán Data Analytics lần này tiếp tục là một chủ đề về Logistics - hay nói nôm na là &ldquo;ship hàng&rdquo;. Nhiệm vụ của các đội là xác định các đơn hàng giao trễ hẹn dựa trên data và bộ rule cho sẵn. Sau một khoảng thời gian tìm hiểu và implement thì mình xin giới thiệu đến các bạn giải pháp của team (score: 1.0/1.0).">
<meta name=twitter:description content="Logistics Problem là challenge thứ x của Shopee Code League 2020 - một cuộc thi về Code và Data kéo dài 2 tháng với các challenge khác nhau. Bài toán Data Analytics lần này tiếp tục là một chủ đề về Logistics - hay nói nôm na là &ldquo;ship hàng&rdquo;. Nhiệm vụ của các đội là xác định các đơn hàng giao trễ hẹn dựa trên data và bộ rule cho sẵn. Sau một khoảng thời gian tìm hiểu và implement thì mình xin giới thiệu đến các bạn giải pháp của team (score: 1.0/1.0).">
<meta property="og:locale" content="vi">
<meta property="article:published_time" content="2020-07-19T11:55:24">
<meta property="article:modified_time" content="2020-07-19T11:55:24">
<meta property="article:section" content="analysis">
<meta property="article:tag" content="data">
<meta property="article:tag" content="python">
<meta property="article:tag" content="programming">
<meta name=twitter:card content="summary">
<meta property="fb:app_id" content="445006706177461">
<meta property="og:image" content="https://chidokun.github.io/thumbnails/shopee-code-league.jpg">
<meta property="twitter:image" content="https://chidokun.github.io/thumbnails/shopee-code-league.jpg">
<meta property="og:image" content="https://www.gravatar.com/avatar/e09926cb6ae66048297c59c891a02e50?s=640">
<meta property="twitter:image" content="https://www.gravatar.com/avatar/e09926cb6ae66048297c59c891a02e50?s=640">
<title>Logistics Problem (Shopee Code League 2020)</title>
<meta name=google-site-verification content="MgXdDXZwDhcwwTzczA6YhQBynidGFAQUBd7PKu2ubfI">
<link rel=icon href=https://chidokun.github.io/favicon.png>
<link rel=canonical href=https://chidokun.github.io/2020/07/logistics-problem/>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin=anonymous>
<link href="https://fonts.googleapis.com/css?family=Noto+Serif:400,700|Roboto+Mono&display=swap&subset=vietnamese" rel=stylesheet>
<link rel=stylesheet href=https://chidokun.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css>
<link rel=stylesheet crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css integrity=sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-64965138-2','auto'),ga('send','pageview'))</script>
</head>
<body>
<div id=blog>
<header id=header data-behavior=5>
<i id=btn-open-sidebar class="fa fa-lg fa-bars"></i>
<div class=header-title>
<a class=header-title-link href=https://chidokun.github.io/>Nguyễn Tuấn's Blog</a>
</div>
<a class="header-right-icon st-search-show-outputs" href=https://chidokun.github.io/#search>
<i class="fa fa-lg fa-search"></i>
</a>
</header>
<nav id=sidebar data-behavior=5>
<div class=sidebar-container>
<div class=sidebar-profile>
<a href=https://chidokun.github.io/#about>
<img class=sidebar-profile-picture src="https://www.gravatar.com/avatar/e09926cb6ae66048297c59c891a02e50?s=110" alt="Ảnh đại diện">
</a>
<h4 class=sidebar-profile-name>Nguyễn Tuấn</h4>
<h5 class=sidebar-profile-bio>A guy with passionate at the code</h5>
</div>
<ul class=sidebar-buttons>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://chidokun.github.io/>
<i class="sidebar-button-icon fa fa-lg fa-home"></i>
<span class=sidebar-button-desc>Trang chủ</span>
</a>
</li>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://chidokun.github.io/categories>
<i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
<span class=sidebar-button-desc>Danh mục</span>
</a>
</li>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://chidokun.github.io/tags>
<i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Thẻ thông tin</span>
</a>
</li>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://chidokun.github.io/archives>
<i class="sidebar-button-icon fa fa-lg fa-archive"></i>
<span class=sidebar-button-desc>Lưu trữ</span>
</a>
</li>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://chidokun.github.io/#about>
<i class="sidebar-button-icon fa fa-lg fa-question"></i>
<span class=sidebar-button-desc>Thông tin</span>
</a>
</li>
</ul>
<ul class=sidebar-buttons>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://github.com/chidokun target=_blank rel=noopener>
<i class="sidebar-button-icon fa fa-lg fa-github"></i>
<span class=sidebar-button-desc>GitHub</span>
</a>
</li>
</ul>
<ul class=sidebar-buttons>
<li class=sidebar-button>
<a class=sidebar-button-link href=https://chidokun.github.io/index.xml>
<i class="sidebar-button-icon fa fa-lg fa-rss"></i>
<span class=sidebar-button-desc>RSS</span>
</a>
</li>
</ul>
</div>
</nav>
<div id=main data-behavior=5 class=hasCoverMetaIn>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<div class="post-header main-content-wrap text-left">
<h1 class=post-title itemprop=headline>
Logistics Problem (Shopee Code League 2020)
</h1>
<div class="postShorten-meta post-meta">
<time itemprop=datePublished datetime=2020-07-19T11:55:24+07:00>
19 tháng 7 2020
</time>
<span>mục</span>
<a class=category-link href=https://chidokun.github.io/categories/analysis>analysis</a>
</div>
<div>
<div class=fb-like data-href=https://chidokun.github.io/2020/07/logistics-problem/ data-width data-layout=button_count data-action=like data-size=large data-share=false></div>
</div>
</div>
<div class="post-content markdown" itemprop=articleBody>
<div class=main-content-wrap>
<p><strong>Logistics Problem</strong> là challenge thứ x của Shopee Code League 2020 - một cuộc thi về Code và Data kéo dài 2 tháng với các challenge khác nhau. Bài toán Data Analytics lần này tiếp tục là một chủ đề về Logistics - hay nói nôm na là <em>&ldquo;ship hàng&rdquo;</em>. Nhiệm vụ của các đội là xác định các đơn hàng giao trễ hẹn dựa trên data và bộ rule cho sẵn. Sau một khoảng thời gian tìm hiểu và implement thì mình xin giới thiệu đến các bạn giải pháp của team (score: 1.0/1.0).</p>
<h1 id=1-quan-sát-dữ-liệu>1. Quan sát dữ liệu</h1>
<p>Đề bài và mô tả dữ liệu trên Kaggle: <a href=https://www.kaggle.com/c/open-shopee-code-league-logistic>[Open] Shopee Code League - Logistics</a></p>
<div class="figure center">
<a class=fancybox href=https://chidokun.github.io/images/post/logistics-problem/1.png title="Dữ liệu được public trên Kaggle" data-fancybox-group>
<img class=fig-img src=https://chidokun.github.io/images/post/logistics-problem/1.png style=width:100% alt="Dữ liệu được public trên Kaggle">
</a>
<span class=caption>Dữ liệu được public trên Kaggle</span>
</div>
<p>Dữ liệu có 3.176.313 dòng x 6 cột:</p>
<ul>
<li><strong>orderid</strong>: Mã đơn hàng, duy nhất trên toàn bộ dữ liệu.</li>
<li><strong>pick</strong>: Thời gian lấy hàng dưới dạng epoch timestamp seconds.</li>
<li><strong>1st_deliver_attempt</strong>: Thời gian giao hàng lần 1 dưới dạng epoch timestamp seconds.</li>
<li><strong>2nd_deliver_attempt</strong>: Thời gian giao hàng lần 2 dưới dạng epoch timestamp seconds. Nếu 1 đơn hàng được giao thành công trong lần đầu thì sẽ không có lần giao thứ 2.</li>
<li><strong>buyeraddress</strong>: Địa điểm người mua (địa điểm đích).</li>
<li><strong>selleraddress</strong>: Địa điểm người bán (địa điểm gốc).</li>
</ul>
<p>Một dòng dữ liệu thể hiện cho <strong>một đơn hàng</strong> trên nền tảng Shopee.</p>
<h1 id=2-phân-tích-yêu-cầu>2. Phân tích yêu cầu</h1>
<p>Yêu cầu của bài toán lần này khá đơn giản: <em>Xác định các đơn hàng giao trễ dựa trên</em> <strong>Service Level Agreements (SLA)</strong>.</p>
<p><strong>SLA</strong> mô tả khoảng thời gian giao hàng cam kết của một đối tác giao hàng giữa 2 địa điểm và được định nghĩa dưới đây:</p>
<div class="figure center">
<a class=fancybox href=https://chidokun.github.io/images/post/logistics-problem/2.png title="Ma trận SLA giữa các địa điểm" data-fancybox-group>
<img class=fig-img src=https://chidokun.github.io/images/post/logistics-problem/2.png style=width:100% alt="Ma trận SLA giữa các địa điểm">
</a>
<span class=caption>Ma trận SLA giữa các địa điểm</span>
</div>
<p>Thời gian giao hàng bắt đầu tính từ <strong>ngày tiếp theo</strong> sau ngày lấy hàng (pick up date) đến lần giao hàng thứ nhất. Nếu lần đầu giao hàng không thành công thì <strong>lần giao hàng thứ hai không được lớn hơn 3 ngày từ lần giao thứ nhất, bất kể lộ trình</strong>.</p>
<p>Thời gian giao hàng chỉ tính từ Thứ Hai đến Thứ Bảy và loại trừ 4 ngày lễ:</p>
<ul>
<li>2020-03-08</li>
<li>2020-03-25</li>
<li>2020-03-30</li>
<li>2020-03-31</li>
</ul>
<div class="alert info">
<p><strong>Lưu ý</strong>: cần chuyển epoch timestamp sang GMT+8 trước khi tính toán.</p>
</div>
<p>Như vậy ta có các rule sau để xác định đơn hàng trễ:</p>
<ul>
<li>
<p>Thời gian từ lúc lấy hàng đến lúc giao lần 1 lớn hơn thời gian cam kết SLA giữa 2 địa điểm người bán và người mua.</p>
</li>
<li>
<p>Hoặc nếu có giao lần thứ hai thì thời gian giao hàng từ lần giao thứ nhất tới lần giao thứ hai lớn hơn 3 ngày.</p>
</li>
</ul>
<h1 id=3-tìm-giải-pháp>3. Tìm giải pháp</h1>
<p>Load dữ liệu và xem những thuộc tính của dữ liệu:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>data_path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;./data/delivery_orders_march.csv&#34;</span>
result_path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;./data/result.csv&#34;</span>
d <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(data_path)
</code></pre></div>
<div class="figure center">
<a class=fancybox href=https://chidokun.github.io/images/post/logistics-problem/3.png title="Sơ lược về dữ liệu" data-fancybox-group>
<img class=fig-img src=https://chidokun.github.io/images/post/logistics-problem/3.png style=width:100% alt="Sơ lược về dữ liệu">
</a>
<span class=caption>Sơ lược về dữ liệu</span>
</div>
<p>Fix những giá trị bị miss.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>d[<span style=color:#e6db74>&#39;1st_deliver_attempt&#39;</span>] <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#39;1st_deliver_attempt&#39;</span>]<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>int64)
d[<span style=color:#e6db74>&#39;2nd_deliver_attempt&#39;</span>] <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#39;2nd_deliver_attempt&#39;</span>]<span style=color:#f92672>.</span>fillna(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>astype(np<span style=color:#f92672>.</span>int64)
</code></pre></div><p>Khởi tạo các địa điểm và mảng SLA phục vụ tính toán SLA.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>holidays <span style=color:#f92672>=</span> [ <span style=color:#e6db74>&#34;2020-03-08&#34;</span>, <span style=color:#e6db74>&#34;2020-03-25&#34;</span>, <span style=color:#e6db74>&#34;2020-03-30&#34;</span>, <span style=color:#e6db74>&#34;2020-03-31&#34;</span> ]

places <span style=color:#f92672>=</span> [ <span style=color:#e6db74>&#34;metro manila&#34;</span>, <span style=color:#e6db74>&#34;luzon&#34;</span>, <span style=color:#e6db74>&#34;visayas&#34;</span>, <span style=color:#e6db74>&#34;mindanao&#34;</span> ]

<span style=color:#75715e># mapping for city index</span>
places_map <span style=color:#f92672>=</span> { place:i <span style=color:#66d9ef>for</span> i, place <span style=color:#f92672>in</span> enumerate(places)}

<span style=color:#75715e># sla_map[seller][buyer]</span>
sla_map <span style=color:#f92672>=</span> [[<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>],
           [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>],
           [<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>],
           [<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>]]
</code></pre></div><p>Xác định địa điểm người bán và người mua, giải quyết trường hợp trùng tên địa điểm nhưng ở những vị trí khác nhau. Sau đó thay thế địa chỉ bằng index của địa điểm trong SLA map.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># convert address to city index</span>
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_place_index</span>(address): 
    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>argmax([address<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>rfind(i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> places])

d[<span style=color:#e6db74>&#34;buyeraddress&#34;</span>] <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#34;buyeraddress&#34;</span>]<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: get_place_index(x))
d[<span style=color:#e6db74>&#34;selleraddress&#34;</span>] <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#34;selleraddress&#34;</span>]<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: get_place_index(x))
</code></pre></div><p>Tính toán SLA cho toàn bộ dữ liệu.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>d[<span style=color:#e6db74>&#34;sla&#34;</span>] <span style=color:#f92672>=</span> d<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: sla_map[x[<span style=color:#e6db74>&#34;selleraddress&#34;</span>]][x[<span style=color:#e6db74>&#34;buyeraddress&#34;</span>]], axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</code></pre></div><p>Chuyển timestamp ở các cột ngày thành GMT+8 và bỏ đi phần time.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>dt_columns <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;pick&#39;</span>, <span style=color:#e6db74>&#39;1st_deliver_attempt&#39;</span>, <span style=color:#e6db74>&#39;2nd_deliver_attempt&#39;</span>]
<span style=color:#66d9ef>for</span> dt_col <span style=color:#f92672>in</span> dt_columns:
    d[dt_col] <span style=color:#f92672>=</span> (d[dt_col] <span style=color:#f92672>+</span> <span style=color:#ae81ff>3600</span><span style=color:#f92672>*</span><span style=color:#ae81ff>8</span>) <span style=color:#f92672>//</span> (<span style=color:#ae81ff>3600</span><span style=color:#f92672>*</span><span style=color:#ae81ff>24</span>)
</code></pre></div><p>Tính toán ngày giao hàng dùng hàm busday_count của NumPy.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>t1 <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#39;pick&#39;</span>]<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>astype(<span style=color:#e6db74>&#39;datetime64[D]&#39;</span>)
t2 <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#39;1st_deliver_attempt&#39;</span>]<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>astype(<span style=color:#e6db74>&#39;datetime64[D]&#39;</span>)
t3 <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#39;2nd_deliver_attempt&#39;</span>]<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>astype(<span style=color:#e6db74>&#39;datetime64[D]&#39;</span>)

d[<span style=color:#e6db74>&#39;num_days1&#39;</span>] <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>busday_count(t1, t2, weekmask<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1111110&#34;</span>, holidays<span style=color:#f92672>=</span>holidays)
d[<span style=color:#e6db74>&#39;num_days2&#39;</span>] <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>busday_count(t2, t3, weekmask<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1111110&#34;</span>, holidays<span style=color:#f92672>=</span>holidays)
</code></pre></div><p>Cuối cùng là xác định đơn hàng giao trễ dựa trên các rule đã xác định.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>d[<span style=color:#e6db74>&#39;is_late&#39;</span>] <span style=color:#f92672>=</span> (d[<span style=color:#e6db74>&#39;num_days1&#39;</span>] <span style=color:#f92672>&gt;</span> d[<span style=color:#e6db74>&#39;sla&#39;</span>]) <span style=color:#f92672>|</span> (d[<span style=color:#e6db74>&#39;num_days2&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>3</span>)
d[<span style=color:#e6db74>&#39;is_late&#39;</span>] <span style=color:#f92672>=</span> d[<span style=color:#e6db74>&#39;is_late&#39;</span>]<span style=color:#f92672>.</span>astype(int)
</code></pre></div><p>Ghi file và nộp.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>result <span style=color:#f92672>=</span> d[[<span style=color:#e6db74>&#34;orderid&#34;</span>, <span style=color:#e6db74>&#34;is_late&#34;</span>]]
result<span style=color:#f92672>.</span>to_csv(result_path, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</code></pre></div><p>Bóc thử những thằng trễ ra xem nó như thế nào :D</p>
<div class="figure center">
<a class=fancybox href=https://chidokun.github.io/images/post/logistics-problem/4.png title="Những đơn hàng giao trễ" data-fancybox-group>
<img class=fig-img src=https://chidokun.github.io/images/post/logistics-problem/4.png style=width:100% alt="Những đơn hàng giao trễ">
</a>
<span class=caption>Những đơn hàng giao trễ</span>
</div>
<p>Sau khi chạy xử lý xong thì phát hiện có <strong>762.422</strong> đơn hàng giao trễ :D</p>
<p>Các bạn có thể xem toàn bộ notebook, dữ liệu tại GitHub: <a href=https://github.com/chidokun/logistics-shopee-code-league>logistics-shopee-code-league</a></p>
<h1 id=4-nhận-định>4. Nhận định</h1>
<p>So với challenge trước (Order Burshing Problem), challenge lần này có các rule đơn giản hơn. Nhưng cũng sẽ khó hơn tí vì lượng dữ liệu khá lớn. Nếu chưa có nhiều kinh nghiệm xử lý dữ liệu và tối ưu hóa thì có thể sẽ không kịp thời gian làm bài (thời gian làm cho challenge này là 3 giờ).</p>
<p>Many thanks for my teammate <strong><a href=https://github.com/hoanghouit>@hoanghouit</a></strong> (Business Analyst), <strong><a href=https://github.com/XuanVuong>@XuanVuong</a></strong> (Business Analyst), <strong><a href=https://github.com/PhamVanMinh272>@PhamVanMinh272</a></strong> (Data Engineer), <strong><a href=https://github.com/nlchibao>@nlchibao</a></strong> (ML Engineer).</p>
</div>
</div>
<div id=post-footer class="post-footer main-content-wrap">
<div class=post-footer-tags>
<span class="text-color-light text-small">THẺ ĐÁNH DẤU</span><br>
<a class="tag tag--primary tag--small" href=https://chidokun.github.io/tags/data/>data</a>
<a class="tag tag--primary tag--small" href=https://chidokun.github.io/tags/python/>python</a>
<a class="tag tag--primary tag--small" href=https://chidokun.github.io/tags/programming/>programming</a>
</div>
<div class=post-actions-wrap>
<nav>
<ul class="post-actions post-action-nav">
<li class=post-action>
<a class="post-action-btn btn btn--default tooltip--top" href=https://chidokun.github.io/2021/01/crawl-tiki-products-p2/ data-tooltip="Tập tành crawl dữ liệu product của Tiki (Phần 2)">
<i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">Tiếp</span>
</a>
</li>
<li class=post-action>
<a class="post-action-btn btn btn--default tooltip--top" href=https://chidokun.github.io/2020/06/order-brushing/ data-tooltip="Order Brushing Problem (Shopee Code League 2020)">
<span class="hide-xs hide-sm text-small icon-mr">Trước</span>
<i class="fa fa-angle-right"></i>
</a>
</li>
</ul>
</nav>
<ul class="post-actions post-action-share">
<li class="post-action hide-lg hide-md hide-sm">
<a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions>
<i class="fa fa-share-alt"></i>
</a>
</li>
<li class="post-action hide-xs">
<a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://chidokun.github.io/2020/07/logistics-problem/">
<i class="fa fa-facebook-official"></i>
</a>
</li>
<li class="post-action hide-xs">
<a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://chidokun.github.io/2020/07/logistics-problem/">
<i class="fa fa-twitter"></i>
</a>
</li>
<li class="post-action hide-xs">
<a class="post-action-btn btn btn--default" target=new href="https://plus.google.com/share?url=https://chidokun.github.io/2020/07/logistics-problem/">
<i class="fa fa-google-plus"></i>
</a>
</li>
<li class=post-action>
<a class="post-action-btn btn btn--default" href=#disqus_thread>
<i class="fa fa-comment-o"></i>
</a>
</li>
<li class=post-action>
<a class="post-action-btn btn btn--default" href=#>
<i class="fa fa-list"></i>
</a>
</li>
</ul>
</div>
<div id=fb-root></div>
<script>(function(b,c,d){var a,e=b.getElementsByTagName(c)[0];if(b.getElementById(d))return;a=b.createElement(c),a.id=d,a.src='https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v3.1&appId=445006706177461&autoLogAppEvents=1',e.parentNode.insertBefore(a,e)})(document,'script','facebook-jssdk')</script>
<div id=fb-cmt-thread class=fb-comments data-href=https://chidokun.github.io/2020/07/logistics-problem/ data-width=100%></div>
</div>
</article>
<footer id=footer class=main-content-wrap>
<span class=copyrights>
&copy; 2021 <a href=https://github.com/chidokun>Nguyễn Tuấn</a>. All Rights Reserved
</span>
</footer>
</div>
<div id=bottom-bar class=post-bottom-bar data-behavior=5>
<div class=post-actions-wrap>
<nav>
<ul class="post-actions post-action-nav">
<li class=post-action>
<a class="post-action-btn btn btn--default tooltip--top" href=https://chidokun.github.io/2021/01/crawl-tiki-products-p2/ data-tooltip="Tập tành crawl dữ liệu product của Tiki (Phần 2)">
<i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">Tiếp</span>
</a>
</li>
<li class=post-action>
<a class="post-action-btn btn btn--default tooltip--top" href=https://chidokun.github.io/2020/06/order-brushing/ data-tooltip="Order Brushing Problem (Shopee Code League 2020)">
<span class="hide-xs hide-sm text-small icon-mr">Trước</span>
<i class="fa fa-angle-right"></i>
</a>
</li>
</ul>
</nav>
<ul class="post-actions post-action-share">
<li class="post-action hide-lg hide-md hide-sm">
<a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions>
<i class="fa fa-share-alt"></i>
</a>
</li>
<li class="post-action hide-xs">
<a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://chidokun.github.io/2020/07/logistics-problem/">
<i class="fa fa-facebook-official"></i>
</a>
</li>
<li class="post-action hide-xs">
<a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://chidokun.github.io/2020/07/logistics-problem/">
<i class="fa fa-twitter"></i>
</a>
</li>
<li class="post-action hide-xs">
<a class="post-action-btn btn btn--default" target=new href="https://plus.google.com/share?url=https://chidokun.github.io/2020/07/logistics-problem/">
<i class="fa fa-google-plus"></i>
</a>
</li>
<li class=post-action>
<a class="post-action-btn btn btn--default" href=#disqus_thread>
<i class="fa fa-comment-o"></i>
</a>
</li>
<li class=post-action>
<a class="post-action-btn btn btn--default" href=#>
<i class="fa fa-list"></i>
</a>
</li>
</ul>
</div>
</div>
<div id=share-options-bar class=share-options-bar data-behavior=5>
<i id=btn-close-shareoptions class="fa fa-close"></i>
<ul class=share-options>
<li class=share-option>
<a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fchidokun.github.io%2F2020%2F07%2Flogistics-problem%2F">
<i class="fa fa-facebook-official"></i><span>Chia sẻ với Facebook</span>
</a>
</li>
<li class=share-option>
<a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fchidokun.github.io%2F2020%2F07%2Flogistics-problem%2F">
<i class="fa fa-twitter"></i><span>Chia sẻ với Twitter</span>
</a>
</li>
<li class=share-option>
<a class=share-option-btn target=new href="https://plus.google.com/share?url=https%3A%2F%2Fchidokun.github.io%2F2020%2F07%2Flogistics-problem%2F">
<i class="fa fa-google-plus"></i><span>Chia sẻ với Google+</span>
</a>
</li>
</ul>
</div>
<div id=share-options-mask class=share-options-mask></div>
</div>
<div id=about>
<div id=about-card>
<div id=about-btn-close>
<i class="fa fa-remove"></i>
</div>
<img id=about-card-picture src="https://www.gravatar.com/avatar/e09926cb6ae66048297c59c891a02e50?s=110" alt="Ảnh đại diện">
<h4 id=about-card-name>Nguyễn Tuấn</h4>
<div id=about-card-bio>A guy with passionate at the code</div>
<div id=about-card-job>
<i class="fa fa-briefcase"></i>
<br>
Software Engineer
</div>
<div id=about-card-location>
<i class="fa fa-map-marker"></i>
<br>
Saigon, Vietnam
</div>
</div>
</div>
<div id=cover style=background-image:url(https://chidokun.github.io/images/background.jpg)></div>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin=anonymous></script>
<script src=https://chidokun.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js></script>
<script crossorigin=anonymous integrity=sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js></script>
<script crossorigin=anonymous integrity=sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js></script>
<script src=https://chidokun.github.io/js/main.js></script>
<script lang=javascript>window.onload=updateMinWidth,window.onresize=updateMinWidth,document.getElementById("sidebar").addEventListener("transitionend",updateMinWidth);function updateMinWidth(){var b=document.getElementById("sidebar"),a=document.getElementById("main"),c,d,e;a.style.minWidth="",c=getComputedStyle(a).getPropertyValue("min-width"),d=getComputedStyle(b).getPropertyValue("width"),e=getComputedStyle(b).getPropertyValue("left"),a.style.minWidth=`calc(${c} - ${d} - ${e})`}</script>
<script>$(document).ready(function(){hljs.configure({classPrefix:'',useBR:!1}),$('pre.code-highlight > code, pre > code').each(function(b,a){$(this).hasClass('codeblock')||$(this).addClass('codeblock'),hljs.highlightBlock(a)})})</script>
<script>var disqus_config=function(){this.page.url='https://chidokun.github.io/2020/07/logistics-problem/',this.page.identifier='/2020/07/logistics-problem/'};(function(){var a,b,c;if(window.location.hostname=="localhost")return;a=document,b=a.createElement('script'),c='nguyentuanit96',b.src='//'+c+'.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script>
</body>
</html>